{% extends "layout.html" %}

{% block content %}

<div class="jumbotron">
    <h2>All Unanalyzed Unit Tests</h2>
</div>
<div class="row">
    <div class="col-md-12">
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Class Name</th>
                        <th>Test Name</th>
                        <th>Type</th>
                        <th>Result</th>
                        <th>TFS Bug ID</th>
                        <th>Error Message</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for record in records %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ record['ClassName'] }}</td>
                        <td>{{ record['TestName'] }}</td>
                        <td>{{ record['Type'] }}</td>
                        <td>{{ record['Result'] }}</td>
                        <td>{{ record['TFSBugID'] }}</td>
                        <td>
                            <a tabindex="0" class="btn" role="button" data-placement="left" data-toggle="popover" data-trigger="focus" title="{{ record['TestName'] }}" data-content="{{ record['ErrorMessage'] }}">View detailed Error</a>
                        </td>
                        <td>
                            <!-- Trigger the modal with a button -->
                            <a  class="btn btn-primary" role="button" data-toggle="modal" data-target="#{{ loop.index }}">Analyze With Bugs</a>
                            
                            <!-- Modal -->
                            <div class="modal fade" id="{{ loop.index }}" role="dialog">
                                <div class="modal-dialog modal-sm">

                                    <!-- Modal content-->
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                                            <h4 class="modal-title">Analyze Failed Cases With TFS Bug</h4>
                                        </div>
                                        <div class="modal-body">
                                            <form class="form-inline" method="POST" action="{{ url_for('analyze') }}">
                                                <div class="form-group">
                                                    <label class="sr-only" for="exampleInputAmount">TFS Bug ID</label>
                                                    <div class="input-group">
                                                        <input type="hidden" name="build" value="{{ build }}"/>
                                                        <input type="hidden" name="classname" value="{{ record['ClassName'] }}" />
                                                        <input type="hidden" name="testname" value="{{ record['TestName'] }}" />
                                                        <input type="text" class="form-control" id="bugid" name="bugid" placeholder="please enter TFS bug ID">
                                                    </div>
                                                </div>
                                                <button type="submit" class="btn btn-primary">Analyze</button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>                                     
                            <a href="#">Mark as Passed </a>

                        </td>
                    </tr>


                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

{% endblock %}
{% block scripts %}
<script>
    $(function () {
        $('[data-toggle="popover"]').popover()
    })
</script>
{% endblock %}